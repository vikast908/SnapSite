<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <script>
    // Apply theme immediately before CSS loads
    (function() {
      const browserAPI = typeof browser !== 'undefined' ? browser : chrome;
      browserAPI.storage.sync.get(['snapsiteTheme'], function(result) {
        document.documentElement.setAttribute('data-theme', result.snapsiteTheme === 'dark' ? 'dark' : 'light');
      });
    })();
  </script>
  <link rel="stylesheet" href="ui.css">
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <!-- Header -->
  <div class="popup-header">
    <div class="brand">
      <svg class="logo" viewBox="0 0 512 512" width="24" height="24">
        <rect x="16" y="16" width="480" height="480" rx="96" fill="#14B8A6" stroke="none"/>
        <path d="M96 160 V120 Q96 96 120 96 H160" stroke="white" stroke-width="20" stroke-linecap="round" fill="none"/>
        <path d="M416 160 V120 Q416 96 392 96 H352" stroke="white" stroke-width="20" stroke-linecap="round" fill="none"/>
        <path d="M96 352 V392 Q96 416 120 416 H160" stroke="white" stroke-width="20" stroke-linecap="round" fill="none"/>
        <path d="M416 352 V392 Q416 416 392 416 H352" stroke="white" stroke-width="20" stroke-linecap="round" fill="none"/>
        <rect x="156" y="136" width="200" height="240" rx="24" fill="white" stroke="none"/>
        <circle cx="186" cy="166" r="8" fill="#FF5F57" stroke="none"/>
        <circle cx="210" cy="166" r="8" fill="#FFBD2E" stroke="none"/>
        <circle cx="234" cy="166" r="8" fill="#28C840" stroke="none"/>
        <g transform="translate(256, 360)">
          <path d="M0 -48 V-12" stroke="white" stroke-width="12" stroke-linecap="round" fill="none"/>
          <path d="M-18 -28 L0 -8 L18 -28" stroke="white" stroke-width="12" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          <rect x="-32" y="0" width="64" height="10" rx="5" fill="white" stroke="none"/>
        </g>
      </svg>
      <span class="brand-name">SnapSite</span>
    </div>
    <a href="#" id="openOptionsLink" class="icon-btn" title="Settings">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 1 1 4 0v.09c0 .67.39 1.27 1 1.51.6.24 1.28.11 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06c-.44.54-.57 1.22-.33 1.82.24.61.84 1 1.51 1H21a2 2 0 1 1 0 4h-.09c-.67 0-1.27.39-1.51 1z"/>
      </svg>
    </a>
  </div>

  <!-- Mode Selector - Segmented Control -->
  <div class="mode-selector">
    <button id="singleModeBtn" class="mode-btn selected" aria-pressed="true">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
      </svg>
      <span>Single Page</span>
    </button>
    <button id="crawlModeBtn" class="mode-btn" aria-pressed="false">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/>
        <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/>
      </svg>
      <span>Crawl Site</span>
    </button>
  </div>

  <!-- Crawl Options (hidden by default) -->
  <div id="crawlOptions" class="crawl-options hidden">
    <label>
      <span>Max pages to crawl:</span>
      <input type="number" id="maxPages" value="10" min="1" max="500">
    </label>
  </div>

  <!-- Action Button - Shows Start or Stop based on state -->
  <button id="startBtn" class="action-btn primary">Start Capture</button>
  <button id="stopBtn" class="action-btn danger hidden">Stop Capture</button>

  <!-- Status -->
  <div class="status-text" id="status">Ready to capture</div>

  <!-- Progress -->
  <div class="progress-container">
    <div class="progress-bar">
      <div id="bar" class="bar"></div>
    </div>
    <div class="progress-meta">
      <span id="countMeta">0 assets</span>
      <span id="elapsedMeta">0s</span>
      <span id="pct" class="pct">0%</span>
    </div>
  </div>

  <script src="browser-polyfill.js"></script>
  <script src="popup.js"></script>
</body>
</html>
